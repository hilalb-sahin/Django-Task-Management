{% extends 'base_content.html' %}
{% block content %}
{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="{% static 'dashboard.js' %}"></script>


</head>


<body>

  <div class="container">
    <div class="row">
      <div class="col-12">
        <h1>Welcome to your dashboard {{ user.username }}</h1>
          {% if messages %}
              <div class="messages">
                {% for message in messages %}
                    <div{% if message.tags %} class="alert {{ message.tags }}"{% endif %}>{{ message }}</div>
                {% endfor %}
              </div>
          {% endif %}
      <p>
            <a href='{% url 'create_team' %}' class="btn btn-lg btn-secondary">
              Create Team
            </a>
        </p>
        <p>
          <a href="{% url 'send_invitation' user_id=user.id %}" class="btn btn-lg btn-secondary">
            Send Invites
          </a>
        </p>

          <!-- Teams Section -->
        <h3>Your Teams</h3>
        <ul>
          {% for team in user.teams.all %}
            <li>
              {{ team.name }} - <a href="{% url 'team_members' team.id %}" class="btn btn-sm btn-primary">View Team Members</a><br><br><br>
            </li>
          {% empty %}
            <li>You are not a member of any teams.</li>
          {% endfor %}
        </ul>

        <h3>Received Invitations</h3>
        <ul>
          {% for invite in received_invitations %}
          <li id="invite-{{ invite.id }}">
            You {{ user.username }} have been invited to join {{ invite.team.name }} by {{ invite.sender.username }}.
            <a href="javascript:void(0);" onclick="acceptInvitation({{ invite.id }})">Accept</a> |
            <a href="javascript:void(0);" onclick="declineInvitation({{ invite.id }})">Decline</a>

          </li>
          {% endfor %}
        </ul>





        <h3>Sent Invitations</h3>
        <ul>
          {% for invite in sent_invitations %}
          <li>
            You have sent an invitation to {{ invite.recipient.username }} to join {{ invite.team.name }}.
          </li>
          {% endfor %}
        </ul>

      </div>
    </div>
  </div>

</body>
</html>
{% endblock %}